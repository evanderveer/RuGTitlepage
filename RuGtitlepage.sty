\usepackage{microtype}
\usepackage{graphicx}
\usepackage{pgfkeys}
\usepackage{pgffor}
\usepackage{datetime}
\usepackage[
    left=1.4cm,
    right=1.4cm,
    top=2cm,
    bottom=1cm,
    paperwidth=17cm,
    paperheight=24cm]{geometry}
\usepackage{iftex}

\ifXeTeX
\usepackage{fontspec}
\setmainfont{Georgia}[
    Path=./fonts/,
    Extension=.ttf,
    UprightFont=*-Regular,
    ItalicFont=*-Italic,
    BoldFont=*-Bold,
    BoldItalicFont=*-BoldItalic
]
\fi

\pagenumbering{gobble} % Remove page numbers

\renewcommand{\dateseparator}{-}
\settimeformat{xxivtime}

\newcommand{\RuGtitle}[1]{
    \newcommand{\@RuGtitle}{
        \begin{minipage}[c][5.5cm]{0.9\linewidth}
            \centering
            \huge \textbf{#1}
        \end{minipage}
    }
}

\newcommand{\RuGdefensedate}[5]{
    \newcommand{\@RuGdefensedate}{\dayofweekname{#1}{#2}{#3} #1 \monthname[#2] {#3} at \formattime{#4}{#5}{0} hours}
}

\newcommand{\RuGrector}[1]{
    \newcommand{\@RuGrector}{
        \begin{minipage}[c][4cm]{\linewidth}
            \centering
            \footnotesize
            to obtain the degree of PhD of the \\
            University of Groningen \\
            on the authority of the \\
            Rector Magnificus #1 \\
            and in accordance with \\
            the decision by the College of Deans. \\
            \vspace{0.4cm}
            This thesis will be defended in public on \\
            \vspace{0.4cm}
            \@RuGdefensedate
        \end{minipage}
    }
}

\newcommand{\RuGcandidate}[4]{
    \newcommand{\@RuGcandidate}{
        \begin{minipage}[t][2cm]{\linewidth}
            \centering
            \large \textbf{#1} \\
            \vspace{0.4cm}
            \footnotesize born on #2 \monthname[#3] #4
        \end{minipage}
    }
}

% =============================================================================
% Committee Members Management
% =============================================================================

% Initialize empty lists for committee members
\newcommand{\@RuGsupervisors}{}
\newcommand{\@RuGcosupervisors}{}
\newcommand{\@RuGassessors}{}

% Commands to add members to each list
\newcommand{\RuGsupervisor}[1]{%
    \listadd{\@RuGsupervisors}{#1}%
}

\newcommand{\RuGcosupervisor}[1]{%
    \listadd{\@RuGcosupervisors}{#1}%
}

\newcommand{\RuGassessor}[1]{%
    \listadd{\@RuGassessors}{#1}%
}

% Helper command to print a list with separators
\newcommand{\@RuGprintlist}[2]{%
    % #1 = list macro name
    % #2 = separator between items
    \let\@RuGlistsep\relax
    \renewcommand{\do}[1]{%
        \@RuGlistsep
        ##1%
        \def\@RuGlistsep{#2}%
    }%
    \dolistloop{#1}%
}

% Command to typeset the committee members
\newcommand{\makeRuGcommittee}{%
    \begin{minipage}{0.9\linewidth}
        \raggedright
        \footnotesize

        % Print supervisors section
        \ifdefempty{\@RuGsupervisors}{}{%
            \textbf{Supervisor(s)} \\
            \@RuGprintlist{\@RuGsupervisors}{\\}%
            \\[\baselineskip]%
        }

        % Print co-supervisors section
        \ifdefempty{\@RuGcosupervisors}{}{%
            \textbf{Co-supervisor(s)} \\
            \@RuGprintlist{\@RuGcosupervisors}{\\}%
            \\[\baselineskip]%
        }

        % Print assessment committee section
        \ifdefempty{\@RuGassessors}{}{%
            \textbf{Assessment Committee} \\
            \@RuGprintlist{\@RuGassessors}{\\}%
        }
    \end{minipage}
}

\newcommand{\makeRuGtitlepage}{
    \includegraphics[width=6cm]{logo.eps}
    \begin{center}
        \@RuGtitle

        \begin{minipage}[c][3.75cm]{\linewidth}
            \centering
            \large \textbf{PhD thesis}
        \end{minipage}

        \@RuGrector

        \begin{minipage}[c][3cm]{\linewidth}
            \centering
            \footnotesize
            by
        \end{minipage}
        
        \vspace{0.3cm}

        \@RuGcandidate
    \end{center}
}